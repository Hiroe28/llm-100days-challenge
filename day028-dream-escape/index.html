<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>夢の境界線 -不思議な部屋からの脱出-</title>
    <link href="https://fonts.googleapis.com/css2?family=Mochiy+Pop+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- タイトル画面 -->
        <div class="title-screen" id="titleScreen">
            <div class="title-overlay"></div>
            <div class="title-content">
                <h1>夢の境界線</h1>
                <p>-不思議な部屋からの脱出-</p>
                <p>病室で眠る少女の夢の世界に迷い込んだあなた。<br>現実に戻るためには、夢の世界の「おかしなところ」を見つけなければなりません。</p>
                <button class="button" id="startButton">物語を見る</button>
            </div>
        </div>
        
        <!-- ストーリー画面 -->
        <div class="story-screen" id="storyScreen">
            <div class="story-content">
                <h2>少女とあなたの物語</h2>
                <img src="assets/story_hospital.png" alt="病室の少女" class="story-image">
                <p>その少女の名前は美月。長い間、原因不明の病気と闘い続けていました。<br>
                白い病室の窓から見える空を眺めながら、彼女はいつも夢想していました。</p>
                
                <p>「ねぇ、あの雲の向こうには何があるのかな？」<br>
                美月はぼんやりとした目で空を見上げ、そうつぶやきます。</p>
                
                <img src="assets/story_dream.png" alt="夢の世界への入り口" class="story-image">
                
                <p>ある夜、あなたは不思議な光に導かれるように、美月の夢の中に迷い込みました。<br>
                そこは彼女の記憶と願いが混ざり合った、現実とも幻想ともつかない世界。</p>
                
                <p>しかし、この夢の世界には「おかしなところ」があります。<br>
                美月の意識が弱まるにつれ、夢の世界の境界線が曖昧になり、現実の記憶が歪んでしまったのです。</p>
                
                <img src="assets/story_distortion.png" alt="歪んだ夢の世界" class="story-image">
                
                <p>「この世界のおかしなところを直していかないと、美月は永遠に夢の中に閉じ込められてしまうかもしれない…」</p>
                
                <p>そんな予感がした瞬間、あなたの前に最初の部屋が姿を現しました。<br>
                美月の大切な思い出が詰まった「思い出のリビング」です。</p>
                
                <div class="story-button-container">
                    <button class="button" id="storyNextButton">探索を始める</button>
                </div>
            </div>
        </div>
        
        <!-- ステージ間遷移画面 -->
        <div class="stage-transition" id="stageTransition">
            <div class="transition-content">
                <h2 id="transitionTitle">次のステージへ</h2>
                <img id="transitionImage" src="" alt="ステージ遷移" class="transition-image">
                <p id="transitionText">次のステージに進みます...</p>
                <button class="button" id="transitionNextButton">次へ進む</button>
            </div>
        </div>
        
        <!-- ゲーム画面 -->
        <div class="game-screen" id="gameScreen">
            <!-- ステージ情報 -->
            <div class="stage-info" id="stageInfo">ステージ1: 思い出のリビング</div>
            
            <!-- 間違いオブジェクトレイヤー -->
            <div class="error-layer" id="errorLayer">
                <!-- 各ステージごとの間違いオブジェクトはJSで動的に追加 -->
            </div>
            
            <!-- 進行度表示 -->
            <div class="progress-container">
                <div class="progress-text">見つけた「おかしなところ」: </div>
                <div class="progress-dots">
                    <div class="progress-dot" id="dot1"></div>
                    <div class="progress-dot" id="dot2"></div>
                    <div class="progress-dot" id="dot3"></div>
                </div>
            </div>
            
            <!-- ヒントボタン -->
            <!-- <button class="hint-button" id="hintButton">?</button> -->

            <!-- BGM操作ボタン -->
            <button class="sound-button" id="bgmControl" title="BGM ON/OFF">🎵</button>

            <!-- メッセージ表示 -->
            <div class="message" id="message"></div>
            
            <!-- クリック判定用のキャンバス（非表示） -->
            <canvas id="hitCanvas" style="display: none;"></canvas>
        </div>
        
        <!-- クリア画面 -->
        <div class="clear-screen" id="clearScreen">
            <div class="clear-content">
                <h2 id="clearTitle">不思議なリビングの記憶が修復されました</h2>
                <img id="clearImage" src="assets/clear_stage1.png" alt="クリア画像" class="clear-image">
                <p id="clearDescription">おかしなところを全て見つけました！<br>
                美月の記憶の一部が正しく修復されました。</p>
                <p id="nextStageDescription">まだ他にも歪んだ場所があるようです。<br>
                次の場所へ進みましょう。</p>
                <button class="button" id="nextStageButton">続ける</button>
            </div>
        </div>
        
        <!-- エンディング画面 -->
        <div class="ending-screen" id="endingScreen">
            <div class="ending-content">
                <h2>目覚めの瞬間</h2>
                <img src="assets/ending_1.png" alt="美月の目覚め" class="ending-image">
                <p>すべての「おかしなところ」を直し終えたとき、<br>
                夢の世界が光に包まれ始めました。</p>
                
                <p>「ありがとう…あなたのおかげで、わたしの記憶が戻ったよ」<br>
                美月の声が空間全体に響き渡ります。</p>
                
                <img src="assets/ending_2.png" alt="病室での再会" class="ending-image">
                
                <p>気がつくと、あなたは病院の廊下に立っていました。<br>
                そして、なぜか美月の病室の前にいることに気づきます。</p>
                
                <p>部屋を覗くと、美月がベッドに座り、窓の外を見つめていました。<br>
                「やっと目が覚めたのね」と、彼女のお母さんが喜びの涙を流しています。</p>
                
                <img src="assets/ending_3.png" alt="回復した美月" class="ending-image">
                
                <p>美月はあなたに気づくと、不思議そうに目を見開きます。<br>
                「あなた…夢の中で会った人ですよね？」</p>
                
                <p>医師によると、美月の意識が戻り、症状も急速に改善しているとのこと。<br>
                退院はもう目前だそうです。</p>
                
                <img src="assets/ending_4.png" alt="未来への一歩" class="ending-image">
                
                <p>あなたが立ち去ろうとすると、美月が小さな紙をあなたに渡しました。<br>
                それは彼女が描いた、あなたと彼女が夢の世界で冒険する姿の絵でした。</p>
                
                <p>「また会えますか？今度は夢の中じゃなくて、現実の世界で…」</p>
                
                <p>あなたは微笑みながら、きっとねと答えました。</p>
                
                <button class="button" id="endingButton">タイトルに戻る</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/stages.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/game.js"></script>
</body>
</html>