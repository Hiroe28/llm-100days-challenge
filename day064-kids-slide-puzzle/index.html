<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Åì„Å©„ÇÇ„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="Â≠ê‰æõÂêë„Åë„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´„Ç≤„Éº„É†„ÄÇ„Åã„Çè„ÅÑ„ÅÑÂãïÁâ©„ÇÑËá™ÁÑ∂„ÅÆÂÜôÁúü„ÅßÊ•Ω„Åó„ÅèÈÅä„Åπ„Çã„ÄÇ3ÊÆµÈöé„ÅÆÈõ£ÊòìÂ∫¶„Å®„Ç´„Çπ„Çø„É†ÁîªÂÉèÂØæÂøú„ÄÇ">
    <meta name="keywords" content="„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´,Â≠ê‰æõÂêë„Åë„Ç≤„Éº„É†,„Éë„Ç∫„É´„Ç≤„Éº„É†,Áü•ËÇ≤„Ç≤„Éº„É†,„Ç≠„ÉÉ„Ç∫„Éë„Ç∫„É´">

    <!-- OGP (Open Graph Protocol) -->
    <meta property="og:title" content="„Åì„Å©„ÇÇ„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´ - Ê•Ω„Åó„ÅèÈÅä„Åπ„ÇãÁü•ËÇ≤„Éë„Ç∫„É´„Ç≤„Éº„É†" />
    <meta property="og:description" content="„Åã„Çè„ÅÑ„ÅÑÂãïÁâ©„ÇÑËá™ÁÑ∂„ÅÆÂÜôÁúü„Çí‰Ωø„Å£„ÅüÂ≠ê‰æõÂêë„Åë„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´„ÄÇ3√ó3„Åã„Çâ5√ó5„Åæ„Åß„ÅÆÈõ£ÊòìÂ∫¶ÈÅ∏Êäû„ÄÅ„Ç´„Çπ„Çø„É†ÁîªÂÉè„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊ©üËÉΩ‰ªò„Åç„ÄÇ" />
    <meta property="og:image" content="https://hiroe28.github.io/llm-100days-challenge/day064-kids-slide-puzzle/screenshot.png" />
    <meta property="og:url" content="https://hiroe28.github.io/llm-100days-challenge/day064-kids-slide-puzzle/index.html" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="„Åì„Å©„ÇÇ„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´" />
    <meta name="twitter:description" content="Â≠ê‰æõÂêë„Åë„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´„Ç≤„Éº„É†„ÄÇ„Åã„Çè„ÅÑ„ÅÑÂãïÁâ©„ÇÑËá™ÁÑ∂„ÅÆÂÜôÁúü„ÅßÊ•Ω„Åó„ÅèÈÅä„Åπ„Çã„ÄÇ3ÊÆµÈöé„ÅÆÈõ£ÊòìÂ∫¶„Å®„Ç´„Çπ„Çø„É†ÁîªÂÉèÂØæÂøú„Åß„ÄÅ‰ΩïÂ∫¶„Åß„ÇÇÊ•Ω„Åó„ÇÅ„ÇãÁü•ËÇ≤„Éë„Ç∫„É´„ÄÇ" />
    <meta property="twitter:image" content="https://hiroe28.github.io/llm-100days-challenge/day064-kids-slide-puzzle/screenshot.png" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 100%;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
                border-radius: 15px;
            }

            h1 {
                font-size: 1.5em;
                margin-bottom: 15px;
            }

            select, button, input[type="file"] {
                padding: 10px;
                font-size: 14px;
            }

            .image-btn {
                padding: 8px;
                font-size: 14px;
            }

            .button-group button {
                min-width: 120px;
                padding: 10px;
            }

            .info {
                font-size: 16px;
            }

            .success-message {
                font-size: 20px;
            }

            #countdown {
                font-size: 36px;
            }
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .celebrating {
            animation: celebrate 0.5s ease-in-out 3;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .controls {
            margin-bottom: 20px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .button-group button {
            flex: 1;
            min-width: 150px;
            margin-top: 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: bold;
        }

        select, button, input[type="file"] {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 2px solid #667eea;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        button {
            background: #667eea;
            color: white;
            font-weight: bold;
            margin-top: 10px;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        #hint-btn {
            background: #52c41a;
            margin-left: 10px;
        }

        #hint-btn:hover {
            background: #45a616;
        }

        #countdown {
            text-align: center;
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
            height: 60px;
        }

        .image-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .image-btn {
            flex: 1;
            min-width: 120px;
            padding: 10px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-btn:hover, .image-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        #puzzle-container {
            display: grid;
            gap: 2px;
            background: #333;
            padding: 2px;
            border-radius: 10px;
            margin: 20px auto;
            width: 100%;
            max-width: min(90vw, 500px);
        }

        .puzzle-piece {
            width: 100%;
            aspect-ratio: 1;
            background-size: cover;
            background-position: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #fff;
        }

        .puzzle-piece:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .puzzle-piece.empty {
            background: #ddd;
            cursor: default;
        }

        .info {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            color: #333;
        }

        .moves {
            font-weight: bold;
            color: #667eea;
        }

        .success-message {
            text-align: center;
            color: #4caf50;
            font-size: 24px;
            font-weight: bold;
            margin-top: 20px;
            display: none;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .celebrating {
            animation: celebrate 0.5s ease-in-out 3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß© „Åì„Å©„ÇÇ„Çπ„É©„Ç§„Éâ„Éë„Ç∫„É´ üß©</h1>
        
        <div class="controls">
            <div class="control-group">
                <label>„Éë„Ç∫„É´„ÅÆ„Åä„Åä„Åç„Åï:</label>
                <select id="size-select">
                    <option value="3" selected>„Åã„Çì„Åü„Çì (3√ó3)</option>
                    <option value="4">„Åµ„Å§„ÅÜ (4√ó4)</option>
                    <option value="5">„ÇÄ„Åö„Åã„Åó„ÅÑ (5√ó5)</option>
                </select>
            </div>

            <div class="control-group">
                <label>„Åå„Åû„ÅÜ„Çí„Åà„Çâ„Å∂:</label>
                <div class="image-options">
                    <button class="image-btn active" data-image="cat">üê± „Å≠„Åì</button>
                    <button class="image-btn" data-image="dog">üê∂ „ÅÑ„Å¨</button>
                    <button class="image-btn" data-image="flower">üå∏ „ÅØ„Å™</button>
                    <button class="image-btn" data-image="nature">üåà „Åó„Åú„Çì</button>
                </div>
                <input type="file" id="custom-image" accept="image/*">
            </div>

            <div class="button-group">
                <button id="start-btn">„ÅÇ„Åü„Çâ„Åó„Åè„ÅØ„Åò„ÇÅ„Çã</button>
                <button id="hint-btn" style="display: none;">„Åä„Å¶„Åª„Çì„Çí„Åø„Çã</button>
            </div>
        </div>

        <div id="countdown" style="display: none;"></div>
        <div id="puzzle-container"></div>

        <div class="info">
            „ÅÜ„Åî„Åã„Åó„Åü„Åã„Åö: <span class="moves" id="moves">0</span>
        </div>

        <div class="success-message" id="success-message">
            üéâ „Åä„ÇÅ„Åß„Å®„ÅÜ! üéâ<br>„Åã„Çì„Åõ„ÅÑ„Åó„Åæ„Åó„Åü!
        </div>
    </div>

    <script>
        let gridSize = 3;
        let tiles = [];
        let emptyIndex;
        let moves = 0;
        let currentImage = '';
        let customImageUrl = null;
        let isPlaying = false;
        let hintTimeout;

        const imageThemes = {
            cat: 'https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=800',
            dog: 'https://images.unsplash.com/photo-1587300003388-59208cc962cb?w=800',
            flower: 'https://images.unsplash.com/photo-1490750967868-88aa4486c946?w=800',
            nature: 'https://images.unsplash.com/photo-1518173946687-a4c8892bbd9f?w=800'
        };

        document.getElementById('size-select').addEventListener('change', (e) => {
            gridSize = parseInt(e.target.value);
        });

        document.querySelectorAll('.image-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.image-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                currentImage = e.target.dataset.image;
                customImageUrl = null;
            });
        });

        document.getElementById('custom-image').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    customImageUrl = event.target.result;
                    document.querySelectorAll('.image-btn').forEach(b => b.classList.remove('active'));
                    initPuzzle();
                };
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('start-btn').addEventListener('click', initPuzzle);
        document.getElementById('hint-btn').addEventListener('click', showHint);

        function initPuzzle() {
            moves = 0;
            isPlaying = false;
            document.getElementById('moves').textContent = moves;
            document.getElementById('success-message').style.display = 'none';
            document.getElementById('hint-btn').style.display = 'none';

            const container = document.getElementById('puzzle-container');
            container.innerHTML = '';
            container.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;

            const totalTiles = gridSize * gridSize;
            tiles = Array.from({length: totalTiles}, (_, i) => i);
            emptyIndex = totalTiles - 1;
            
            // „Åæ„ÅöÂÆåÊàêÂΩ¢„ÇíË°®Á§∫
            renderPuzzle();
            
            // „Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥Ë°®Á§∫
            const countdown = document.getElementById('countdown');
            countdown.style.display = 'block';
            countdown.textContent = '„Åä„Å¶„Åª„Çì„Çí„Åø„Å¶!';
            
            setTimeout(() => {
                countdown.textContent = '3';
                setTimeout(() => {
                    countdown.textContent = '2';
                    setTimeout(() => {
                        countdown.textContent = '1';
                        setTimeout(() => {
                            countdown.textContent = '„Çπ„Çø„Éº„Éà!';
                            countdown.style.display = 'none';
                            shuffleTiles();
                            renderPuzzle();
                            isPlaying = true;
                            document.getElementById('hint-btn').style.display = 'inline-block';
                        }, 1000);
                    }, 1000);
                }, 1000);
            }, 1000);
        }

        function shuffleTiles() {
            for (let i = 0; i < 1000; i++) {
                const validMoves = getValidMoves();
                const randomMove = validMoves[Math.floor(Math.random() * validMoves.length)];
                [tiles[emptyIndex], tiles[randomMove]] = [tiles[randomMove], tiles[emptyIndex]];
                emptyIndex = randomMove;
            }
        }

        function showHint() {
            if (!isPlaying) return;
            
            clearTimeout(hintTimeout);
            
            const currentTiles = [...tiles];
            const currentEmpty = emptyIndex;
            
            // ÂÆåÊàêÂΩ¢„ÇíË°®Á§∫
            tiles = Array.from({length: tiles.length}, (_, i) => i);
            emptyIndex = tiles.length - 1;
            renderPuzzle();
            
            const hintBtn = document.getElementById('hint-btn');
            hintBtn.textContent = '„Åä„Å¶„Åª„Çì„Çí„Åø„Å¶„ÅÑ„Çã...';
            hintBtn.disabled = true;
            
            // 3ÁßíÂæå„Å´ÂÖÉ„Å´Êàª„Åô
            hintTimeout = setTimeout(() => {
                tiles = currentTiles;
                emptyIndex = currentEmpty;
                renderPuzzle();
                hintBtn.textContent = '„Åä„Å¶„Åª„Çì„Çí„Åø„Çã';
                hintBtn.disabled = false;
            }, 3000);
        }

        function getValidMoves() {
            const moves = [];
            const row = Math.floor(emptyIndex / gridSize);
            const col = emptyIndex % gridSize;

            if (row > 0) moves.push(emptyIndex - gridSize);
            if (row < gridSize - 1) moves.push(emptyIndex + gridSize);
            if (col > 0) moves.push(emptyIndex - 1);
            if (col < gridSize - 1) moves.push(emptyIndex + 1);

            return moves;
        }

        function renderPuzzle() {
            const container = document.getElementById('puzzle-container');
            container.innerHTML = '';

            const imageUrl = customImageUrl || imageThemes[currentImage] || imageThemes['cat'];

            tiles.forEach((tileNum, index) => {
                const tile = document.createElement('div');
                tile.className = 'puzzle-piece';
                
                if (tileNum === tiles.length - 1) {
                    tile.classList.add('empty');
                    emptyIndex = index;
                } else {
                    const row = Math.floor(tileNum / gridSize);
                    const col = tileNum % gridSize;
                    
                    // ÁîªÂÉè„ÇíÊ≠£„Åó„ÅèÂàÜÂâ≤„Åô„Çã„Åü„ÇÅ„ÅÆË®àÁÆó
                    const percentX = gridSize > 1 ? (col / (gridSize - 1)) * 100 : 0;
                    const percentY = gridSize > 1 ? (row / (gridSize - 1)) * 100 : 0;
                    
                    tile.style.backgroundImage = `url(${imageUrl})`;
                    tile.style.backgroundSize = `${gridSize * 100}% ${gridSize * 100}%`;
                    tile.style.backgroundPosition = `${percentX}% ${percentY}%`;
                    
                    tile.addEventListener('click', () => moveTile(index));
                }

                container.appendChild(tile);
            });
        }

        function moveTile(index) {
            if (!isPlaying || !getValidMoves().includes(index)) return;

            [tiles[emptyIndex], tiles[index]] = [tiles[index], tiles[emptyIndex]];
            emptyIndex = index;
            moves++;
            document.getElementById('moves').textContent = moves;
            
            renderPuzzle();
            checkWin();
        }

        function checkWin() {
            const isWin = tiles.every((tile, index) => tile === index);
            if (isWin) {
                isPlaying = false;
                document.getElementById('hint-btn').style.display = 'none';
                document.getElementById('success-message').style.display = 'block';
                document.getElementById('puzzle-container').classList.add('celebrating');
                setTimeout(() => {
                    document.getElementById('puzzle-container').classList.remove('celebrating');
                }, 1500);
            }
        }

        // ÂàùÊúüÂåñ
        currentImage = 'cat';
        initPuzzle();
    </script>
</body>
</html>